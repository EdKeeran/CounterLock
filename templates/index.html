<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CounterLock - Deadlock Counter Items</title>
    <style>
        @font-face {
            font-family: 'Forevs';
            src: url('/static/images/Backgrounds&Fonts/Forevs/forevsdemo-medium.otf') format('opentype');
            font-weight: normal;
            font-style: normal;
        }
        @font-face {
            font-family: 'Forevs';
            src: url('/static/images/Backgrounds&Fonts/Forevs/forevsdemo-mediumitalic.otf') format('opentype');
            font-weight: normal;
            font-style: italic;
        }
        @font-face {
            font-family: 'Forevs';
            src: url('/static/images/Backgrounds&Fonts/Forevs/forevsdemo-bold.otf') format('opentype');
            font-weight: bold;
            font-style: normal;
        }
        @font-face {
            font-family: 'Forevs';
            src: url('/static/images/Backgrounds&Fonts/Forevs/forevsdemo-bolditalic.otf') format('opentype');
            font-weight: bold;
            font-style: italic;
        }
        body {
            font-family: 'Forevs', Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background: url('/static/images/Backgrounds&Fonts/Background.png.png') no-repeat center center fixed;
            background-size: cover;
            min-height: 100vh;
            color: #ffffff;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: rgba(0, 0, 0, 0.8);
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.5);
        }
        h1 {
            color: #ffffff;
            text-align: center;
            margin-bottom: 30px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 2px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }
        .team-selection {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        .team-panel {
            padding: 20px;
            background-color: rgba(0, 0, 0, 0.6);
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .team-panel h2 {
            color: #ffffff;
            margin-top: 0;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
        }
        .hero-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        .hero-button {
            width: 80px;
            height: 80px;
            padding: 0;
            border: 3px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            overflow: hidden;
            position: relative;
            background: transparent;
        }
        .hero-button img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }
        .hero-button:hover {
            transform: scale(1.1);
            border-color: rgba(255, 255, 255, 0.5);
        }
        .hero-button.selected {
            border-color: #00ff88;
            box-shadow: 0 0 20px rgba(0, 255, 136, 0.5);
        }
        .hero-name {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            font-family: 'Forevs', Arial, sans-serif;
            font-size: 11px;
            font-weight: bold;
            padding: 6px;
            text-align: center;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            text-transform: uppercase;
            letter-spacing: 1px;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
        }
        .recommendations {
            margin-top: 30px;
        }
        .item-card {
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 8px;
            background-color: rgba(0, 0, 0, 0.6);
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: transform 0.2s ease;
        }
        .item-card:hover {
            transform: translateX(10px);
            background-color: rgba(0, 0, 0, 0.8);
        }
        .item-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .item-image {
            width: 50px;
            height: 50px;
            border-radius: 8px;
            object-fit: cover;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }
        .item-details {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        .item-details h3 {
            margin: 0;
            font-size: 1.2em;
            color: #ffffff;
        }
        .item-details p {
            margin: 0;
            font-size: 0.9em;
            color: rgba(255, 255, 255, 0.7);
        }
        .item-category {
            font-size: 0.8em;
            padding: 2px 8px;
            border-radius: 4px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .category-SpiritItems {
            color: #203500;
            background-color: #CE91FF;
            border: 1px solid rgba(206, 145, 255, 0.3);
        }
        .category-VitalityItems {
            color: #203500;
            background-color: #7CBB1E;
            border: 1px solid rgba(124, 187, 30, 0.3);
        }
        .category-WeaponItems {
            color: #203500;
            background-color: #DD9642;
            border: 1px solid rgba(221, 150, 66, 0.3);
        }
        .item-right {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .level-badge {
            padding: 5px 15px;
            border-radius: 4px;
            color: white;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
        }
        .level-6 { background-color: #ff0055; box-shadow: 0 0 10px rgba(255, 0, 85, 0.5); }
        .level-5 { background-color: #ff3300; box-shadow: 0 0 10px rgba(255, 51, 0, 0.5); }
        .level-4 { background-color: #ff6600; box-shadow: 0 0 10px rgba(255, 102, 0, 0.5); }
        .level-3 { background-color: #00cc66; box-shadow: 0 0 10px rgba(0, 204, 102, 0.5); }
        .level-2 { background-color: #0099ff; box-shadow: 0 0 10px rgba(0, 153, 255, 0.5); }
        .level-1 { background-color: #6600ff; box-shadow: 0 0 10px rgba(102, 0, 255, 0.5); }
        .get-recommendations {
            display: block;
            width: 100%;
            padding: 15px;
            margin: 20px 0;
            background-color: rgba(0, 255, 136, 0.2);
            color: #00ff88;
            border: 2px solid #00ff88;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 2px;
            transition: all 0.3s ease;
        }
        .get-recommendations:hover {
            background-color: rgba(0, 255, 136, 0.3);
            box-shadow: 0 0 20px rgba(0, 255, 136, 0.3);
            transform: translateY(-2px);
        }
        .recommendations h2 {
            color: #ffffff;
            text-transform: uppercase;
            letter-spacing: 1px;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>CounterLock</h1>
        <div class="team-selection">
            <div class="team-panel">
                <h2>Your Team</h2>
                <div class="hero-list" id="your-team">
                    <!-- Heroes will be added here dynamically -->
                </div>
            </div>
            <div class="team-panel">
                <h2>Enemy Team</h2>
                <div class="hero-list" id="enemy-team">
                    <!-- Heroes will be added here dynamically -->
                </div>
            </div>
        </div>
        <button class="get-recommendations" onclick="getRecommendations()">Get Counter Items</button>
        <div class="recommendations" id="recommendations">
            <!-- Recommendations will be added here dynamically -->
        </div>
    </div>

    <script>
        let heroes = [];
        let selectedYourTeam = new Set();
        let selectedEnemyTeam = new Set();

        // Fetch heroes when page loads
        fetch('/api/heroes')
            .then(response => response.json())
            .then(data => {
                heroes = data;
                displayHeroes();
            });

        function displayHeroes() {
            const yourTeamDiv = document.getElementById('your-team');
            const enemyTeamDiv = document.getElementById('enemy-team');
            
            heroes.forEach(hero => {
                // Your team heroes
                const yourButton = document.createElement('button');
                yourButton.className = 'hero-button';
                const yourImage = document.createElement('img');
                yourImage.src = hero.image_url;
                yourButton.appendChild(yourImage);
                const yourName = document.createElement('div');
                yourName.className = 'hero-name';
                yourName.textContent = hero.name;
                yourButton.appendChild(yourName);
                yourButton.onclick = () => toggleHero(hero.id, 'your');
                yourTeamDiv.appendChild(yourButton);

                // Enemy team heroes
                const enemyButton = document.createElement('button');
                enemyButton.className = 'hero-button';
                const enemyImage = document.createElement('img');
                enemyImage.src = hero.image_url;
                enemyButton.appendChild(enemyImage);
                const enemyName = document.createElement('div');
                enemyName.className = 'hero-name';
                enemyName.textContent = hero.name;
                enemyButton.appendChild(enemyName);
                enemyButton.onclick = () => toggleHero(hero.id, 'enemy');
                enemyTeamDiv.appendChild(enemyButton);
            });
        }

        function toggleHero(heroId, team) {
            const selectedSet = team === 'your' ? selectedYourTeam : selectedEnemyTeam;
            const buttons = document.querySelectorAll(`#${team}-team .hero-button`);
            const button = Array.from(buttons).find(b => 
                b.querySelector('.hero-name').textContent === heroes.find(h => h.id === heroId).name
            );

            if (selectedSet.has(heroId)) {
                selectedSet.delete(heroId);
                button.classList.remove('selected');
            } else if (selectedSet.size < 6) {
                selectedSet.add(heroId);
                button.classList.add('selected');
            }
        }

        function getRecommendations() {
            if (selectedEnemyTeam.size === 0) {
                alert('Please select at least one enemy hero');
                return;
            }

            fetch('/api/recommend', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    enemy_team: Array.from(selectedEnemyTeam)
                })
            })
            .then(response => response.json())
            .then(data => {
                displayItems(data);
            });
        }

        function displayItems(items) {
            const recsDiv = document.getElementById('recommendations');
            recsDiv.innerHTML = '';
            
            if (items.length === 0) {
                recsDiv.innerHTML = '<p>Select enemy heroes to get item recommendations.</p>';
                return;
            }

            items.forEach(item => {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'item-card';
                
                // Left side with image and name
                const itemInfo = document.createElement('div');
                itemInfo.className = 'item-info';
                
                const itemImage = document.createElement('img');
                itemImage.className = 'item-image';
                itemImage.src = `/static/images/items/${item.category}/${item.name}.png`;
                itemImage.alt = item.name;
                itemInfo.appendChild(itemImage);
                
                const itemDetails = document.createElement('div');
                itemDetails.className = 'item-details';
                
                const itemName = document.createElement('h3');
                itemName.textContent = item.name;
                itemDetails.appendChild(itemName);
                
                itemInfo.appendChild(itemDetails);
                itemDiv.appendChild(itemInfo);
                
                // Right side with level and category
                const itemRight = document.createElement('div');
                itemRight.className = 'item-right';
                
                const levelBadge = document.createElement('span');
                levelBadge.className = 'level-badge';
                levelBadge.textContent = `Level ${item.level}`;
                itemRight.appendChild(levelBadge);
                
                const itemCategory = document.createElement('span');
                itemCategory.className = `item-category category-${item.category}`;
                // Format the category name to add space
                const displayCategory = item.category.replace(/([A-Z][a-z]+)([A-Z][a-z]+)/, '$1 $2');
                itemCategory.textContent = displayCategory;
                itemRight.appendChild(itemCategory);
                
                itemDiv.appendChild(itemRight);
                recsDiv.appendChild(itemDiv);
            });
        }
    </script>
</body>
</html>
